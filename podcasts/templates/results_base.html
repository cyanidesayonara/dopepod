{% extends results.extend|yesno:'base.html,ajax.html' %}

{% block title %}
dopepod
{% endblock %}

{% block center-stage %}
<div class="col-12 results color-5-trans {{ results.view }}">
  <div class="row results-bar">
    <div class="col-12 results-header">
      {% if results.extra_options %}
        <button class="btn-dope results-back" onclick="window.history.back()">
          {% if request.is_ajax %}
            <i class="fas fa-arrow-circle-left"></i>
          {% else %}
            &laquo;
          {% endif %}
        </button>
        <div class="extra-options">
          <a class="btn-dope reverse-toggle results-minimize" data-toggle="collapse" href="#results-collapse{{ results.drop }}" aria-expanded="true" aria-controls="results-collapse" aria-label="Minimize">
            {% if request.is_ajax %}
              <i class="fas fa-minus-circle"></i>
            {% else %}
              -
            {% endif %}
          </a>
          <a class="btn-dope results-close" href="#" aria-label="Close">
            {% if request.is_ajax %}
              <i class="fas fa-times-circle"></i>
            {% else %}
              x
            {% endif %}
          </a>
        </div>
      {% endif %}
      <h1>
        {{ results.header }}
      </h1>
    </div>
  </div>
  <div class="row collapse show results-wrapper" id="results-collapse{{ results.drop }}">
    <div class="col-12 px-0 clearfix">
      <div class="results-buttons">
        {% if results.view == 'grid' %}
          <a class="btn-dope view-button view-icon view-icon-grid d-none active" href="{{ results.urls.full_url }}&view=list">
            {% if request.is_ajax %}
              <i class="fas fa-th"></i>
            {% else %}
              Grid
            {% endif %}
          </a>
          <a class="btn-dope view-button view-icon view-icon-list active" href="{{ results.urls.full_url }}&view=grid">
            {% if request.is_ajax %}
              <i class="fas fa-bars"></i>
            {% else %}
              List
            {% endif %}
          </a>
        {% elif results.view == 'list' %}
          <a class="btn-dope view-button view-icon view-icon-grid active" href="{{ results.urls.full_url }}&view=grid">
            {% if request.is_ajax %}
              <i class="fas fa-bars"></i>
            {% else %}
              List
            {% endif %}
          </a>
          <a class="btn-dope view-button view-icon view-icon-list d-none active" href="{{ results.urls.full_url }}&view=list">
            {% if request.is_ajax %}
              <i class="fas fa-th"></i>
            {% else %}
              Grid
            {% endif %}
          </a>
        {% endif %}
        {% if results.alphabet %}
          {% if results.selected_q|capfirst in results.alphabet %}
            <a class="btn-dope active toggle" data-toggle="collapse" href="#alphabet-collapse{{ results.drop }}" aria-expanded="false" aria-controls="alphabet-collapse">
              {{ results.selected_q|capfirst }}
            </a>
          {% else %}
            <a class="btn-dope toggle" data-toggle="collapse" href="#alphabet-collapse{{ results.drop }}" aria-expanded="false" aria-controls="alphabet-collapse">
              A-Z
            </a>
          {% endif %}
        {% endif %}
        {% if results.genres %}
          {% if results.selected_genre %}
            <a class="btn-dope active toggle" data-toggle="collapse" href="#genre-collapse{{ results.drop }}" aria-expanded="false" aria-controls="genre-collapse">
              {{ results.selected_genre }}
            </a>
          {% else %}
            <a class="btn-dope toggle" data-toggle="collapse" href="#genre-collapse{{ results.drop }}" aria-expanded="false" aria-controls="genre-collapse">
              All Genres
            </a>
          {% endif %}
        {% endif %}
        {% if results.languages %}
          {% if results.selected_language %}
            <a class="btn-dope active toggle" data-toggle="collapse" href="#language-collapse{{ results.drop }}" aria-expanded="false" aria-controls="language-collapse">
              {{ results.selected_language }}
            </a>
          {% else %}
            <a class="btn-dope toggle" data-toggle="collapse" href="#language-collapse{{ results.drop }}" aria-expanded="false" aria-controls="language-collapse">
              All Languages
            </a>
          {% endif %}
        {% endif %}
        {% if results.selected_provider == 'dopepod' %}
          <a class="btn-dope active provider-button" href="{{ results.urls.provider_url }}&provider=itunes">
            On dopepod
          </a>
        {% elif results.selected_provider == 'itunes' %}
          <a class="btn-dope active provider-button" href="{{ results.urls.provider_url }}&provider=dopepod">
            On iTunes
          </a>
        {% endif %}
        {% if results.subscriptions %}
          <a class="btn-dope unsubscribe-button" href="{% url 'unsubscribe' %}">
            Unsubscribe
          </a>
        {% endif %}
      </div>
    </div>
    {% if results.alphabet %}
      <div class="collapse options-collapse" id="alphabet-collapse{{ results.drop }}">
        <div class="options-group">
          {% if results.selected_q|capfirst in results.alphabet %}
            <a class="btn-dope options-button alphabet-button nix-button" href="{{ results.urls.q_url }}" id="alphabet-nix">
              <i class="fas fa-times-circle"></i>
            </a>
          {% endif %}
          {% for letter in results.alphabet %}
          {% if letter == results.selected_q|capfirst %}
          <a class="btn-dope active options-button alphabet-button" href="{{ results.urls.q_url }}&q={{ letter|urlencode }}" id="alphabet-{{ letter }}">
            {% else %}
            <a class="btn-dope options-button alphabet-button" href="{{ results.urls.q_url }}&q={{ letter|urlencode }}" id="alphabet-{{ letter }}">
              {% endif %}
                <span>
                  {{ letter }}
                </span>
              </a>
            {% endfor %}
        </div>
      </div>
    {% endif %}
    {% if results.genres %}
      <div class="collapse options-collapse" id="genre-collapse{{ results.drop }}">
        <div class="options-group">
          {% if results.selected_genre %}
            <a class="btn-dope options-button nix-button" href="{{ results.urls.genre_url }}">
              <i class="fas fa-times-circle"></i>
            </a>
          {% endif %}
          {% for genre in results.genres %}
            {% if not results.selected_genre == genre %}
              <a class="btn-dope options-button" href="{{ results.urls.genre_url }}&genre={{ genre.url_format }}">
                {{ genre }}
              </a>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    {% endif %}
    {% if results.languages %}
      <div class="collapse options-collapse" id="language-collapse{{ results.drop }}">
        <div class="options-group">
          {% if results.selected_language %}
            <a class="btn-dope options-button nix-button" href="{{ results.urls.language_url }}">
              <i class="fas fa-times-circle"></i>
            </a>
          {% endif %}
          {% for language in results.languages %}
            {% if not results.selected_language == language %}
              <a class="btn-dope options-button" href="{{ results.urls.language_url }}&language={{ language.url_format }}">
                {{ language }}
              </a>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    {% endif %}
    {% if results.pagination %}
      {% include 'pagination.html' %}
    {% endif %}

    <div class="col-12 results-content">
      {% if results.podcasts or results.episodes %}
        {% if results.view == 'grid' or results.view == 'list' %}
          {% include 'search.html' %}
        {% elif results.view == 'charts' %}
          {% include 'charts.html' %}
        {% elif results.view == 'subscriptions'%}
          {% include 'subscriptions.html' %}
        {% elif results.view == 'playlist'%}
          {% include 'episodes.html' %}
        {% elif results.view == 'last_played'%}
          {% include 'last_played.html' %}
        {% endif %}
      {% endif %}
    </div>

    {% if results.pagination %}
      {% include 'pagination.html' %}
    {% endif %}
  </div>
</div>
{% endblock %}
