{% if not results.episodes and results.view == "playlist" %}
{% else %}
  <div class="row">
    {% include "results_buttons.min.html" %}
  </div>
{% endif %}
{% if not results.view == "playlist" %}
  <div class="row fade collapse showpod-collapse" id="reviews-collapse">
    <div class="col-12 dope-wrapper">
      <p>
        Coming soon!
      </p>
    </div>
  </div>
{% endif %}
<div class="row fade collapse showpod-collapse show" id="episodes-collapse">
  {% if not results.episodes and results.view == "playlist" %}
    <div class="col-12 dope-wrapper">
      <p>
        No episodes.
      </p>
      <p>
        <a class="browse-link" href="{% url 'search' %}?view=grid">
          Find podcasts!
        </a>
      </p>
    </div>
  {% else %}
    {% if results.pages %}
      {% include "pagination.min.html" %}
    {% endif %}
    <div class="col-12 episodes-content">
      {% if results.episodes %}
        <table class="table episodes-table">
          <thead>
            <tr>
              <th class="order">
                <span>#</span>
              </th>
              <th>
                <span>Title</span>
              </th>
              <th class="released">
                <span>Released</span>
              </th>
              <th class="size">
                <span>Size</span>
              </th>
              <th class="length">
                <span>Length</span>
              </th>
              <th class="expand">
              </th>
            </tr>
          </thead>
          <tbody>
            {% for episode in results.episodes %}
              <tr class="episode-header exp{% if not results.pages and forloop.last %} noborder{% endif %}" tabindex="0" data-toggle="collapse" data-target="#more-collapse{{ episode.position }}" aria-expanded="false">
                <th scope="row">
                  <span >{{ episode.position }}</span>
                </th>
                <td class="title">
                  {% if results.view == "playlist" %}
                    <strong>{{ episode.podcast.title }} - </strong>
                  {% endif %}
                    <span>{{ episode.title }}</span>
                  {% if episode.is_new %}
                    <span class="new">NEW</span>
                  {% endif %}
                </td>
                <td>
                  {% if episode.pubDate %}
                    <span class="date" data-utc="{{ episode.pubDate|date:'U' }}">{{ episode.pubDate|date:"d-m-Y H:i" }}</span>
                  {% else %}
                    <span>N/A</span>
                  {% endif %}
                </td>
                <td>
                  <span>{% if episode.size %}{{ episode.size }}{% else %}N/A{% endif %}</span>
                </td>
                <td>
                  <span>{% if episode.length %}{{ episode.length }}{% else %}N/A{% endif %}</span>
                </td>
                <td>
                  <span class="exp-icon" data-toggle="collapse" data-target="#more-collapse{{ episode.position }}" aria-expanded="false"></span>
                </td>
              </tr>
              <tr>
                <td colspan="6" class="episode-hidden color-3-trans">
                  <div class="collapse fade more-collapse {% if not results.pages and forloop.last %}noborder{% endif %}" id="more-collapse{{ episode.position }}">
                    <p>
                      {% if episode.description %}
                        {{ episode.description }}
                      {% else %}
                        No description
                      {% endif %}
                    </p>
                    {% if results.view == "playlist" %}
                    {% endif %}
                    <div class="episode-buttons">
                      {% if results.view == "playlist" %}
                        <form class="playlist-form" action="{% url 'playlist' %}" method="POST">
                          {% csrf_token %}
                          <input type="hidden" name="mode" value="remove" />
                          <input type="hidden" name="pos" value="{{ episode.position }}" />
                          <button class="btn-dope playlist-remove active" type="submit" title="Remove">
                            <i class="fas fa-times icon"></i>
                          </button>
                        </form>
                        {% if not forloop.first %}
                          <form class="playlist-form" action="{% url 'playlist' %}" method="POST">
                            {% csrf_token %}
                            <input type="hidden" name="mode" value="up" />
                            <input type="hidden" name="pos" value="{{ episode.position }}" />
                            <button class="btn-dope playlist-move-up active" type="submit" title="Move Up">
                              <i class="fas fa-arrow-up"></i>
                            </button>
                          </form>
                        {% endif %}
                        {% if not forloop.last %}
                          <form class="playlist-form" action="{% url 'playlist' %}" method="POST">
                            {% csrf_token %}
                            <input type="hidden" name="mode" value="down" />
                            <input type="hidden" name="pos" value="{{ episode.position }}" />
                            <button class="btn-dope playlist-move-down active" type="submit" title="Move Down">
                              <i class="fas fa-arrow-down"></i>
                            </button>
                          </form>
                        {% endif %}
                      {% endif %}
                      <form class="playlist-form" action="{% url 'playlist' %}" method="POST" target="_blank">
                        {% csrf_token %}
                        <input type="hidden" name="mode" value="play" />
                        {% if results.view == "playlist" %}
                          <input type="hidden" name="pos" value="{{ episode.position }}" />
                        {% else %}
                          <input type="hidden" name="signature" value="{{ episode.signature }}" />
                        {% endif %}
                        <button class="btn-dope playlist-play active" type="submit" title="Play">
                          Play
                        </button>
                      </form>
                      <a class="btn-dope active" href="{{ episode.url }}" title="Download" download>
                        Download
                      </a>
                      {% if results.view == "playlist" %}
                        <a class="btn-dope active showpod-link" data-podid="{{ episode.podcast.podid }}" href="{% url 'showpod' podid=episode.podcast.podid %}">
                          Episodes
                        </a>
                      {% endif %}
                      {% if user.is_authenticated and results.view == "showpod" %}
                        <form class="playlist-form" action="{% url 'playlist' %}" method="POST">
                          {% csrf_token %}
                          <input type="hidden" name="mode" value="add" />
                          <input type="hidden" name="signature" value="{{ episode.signature }}" />
                          <button class="btn-dope active" type="submit" title="Add to Playlist">
                            Add to Playlist
                          </button>
                        </form>
                      {% endif %}
                    </div>
                  </div>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% endif %}
    </div>
    {% if results.pages %}
      {% include "pagination.min.html" %}
    {% endif %}
  {% endif %}
</div>